legend.title = element_blank(),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
wtp_pie <- ggplot(wtp_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8)) +
ggtitle("c") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
wtp_mui_pie <- ggplot(wtp_mui_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8)) +
ggtitle("d") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
ggarrange(local_pie, bio_pie, wtp_pie, wtp_mui_pie,
ncol = 2, nrow = 2,
common.legend = TRUE,
legend = 'bottom')
eng_border <- st_read('D:/Documents/SEER/____STATE_OF_GB____/SEER_GIS/Countries (Great Britain)/england_full_clipped.shp')
map <- ggplot() +
geom_sf(data = eng_border, fill = 'NA', lwd = 1) +
geom_sf(data = lsoa,
aes(fill = class),
color = NA) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8)) +
ggtitle("Urban and rural areas in England") +
theme(plot.title = element_text(size=30, hjust = 0.5),
axis.text.x = element_text(size = 24),
axis.text.y = element_text(size = 24),
legend.text = element_text(size = 22),
legend.title = element_blank(),
legend.position = "none")
figure <- ggarrange(map, pies, ncol = 2, nrow = 1)
figure
figure
local_pie
local_bng <- data.frame(
group = c("urban_benefits", "rural_benefits"),
values = c(sum(local_pop$urban_benefits) / (sum(local_pop$urban_benefits) + sum(local_pop$rural_benefits)),
sum(local_pop$rural_benefits) / (sum(local_pop$urban_benefits) + sum(local_pop$rural_benefits)))
)
bio_bng <- data.frame(
group = c("urban_benefits", "rural_benefits"),
values = c(sum(max_bio_pop$urban_benefits) / (sum(max_bio_pop$urban_benefits) + sum(max_bio_pop$rural_benefits)),
sum(max_bio_pop$rural_benefits) / (sum(max_bio_pop$urban_benefits) + sum(max_bio_pop$rural_benefits)))
)
wtp_bng <- data.frame(
group = c("urban_benefits", "rural_benefits"),
values = c(sum(wtp_pop$urban_benefits) / (sum(wtp_pop$urban_benefits) + sum(wtp_pop$rural_benefits)),
sum(wtp_pop$rural_benefits) / (sum(wtp_pop$urban_benefits) + sum(wtp_pop$rural_benefits)))
)
wtp_mui_bng <- data.frame(
group = c("urban_benefits", "rural_benefits"),
values = c(sum(wtp_pop_mui$urban_benefits) / (sum(wtp_pop_mui$urban_benefits) + sum(wtp_pop_mui$rural_benefits)),
sum(wtp_pop_mui$rural_benefits) / (sum(wtp_pop_mui$urban_benefits) + sum(wtp_pop_mui$rural_benefits)))
)
local_pie <- ggplot(local_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8)) +
ggtitle("a") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
bio_pie <- ggplot(bio_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8)) +
ggtitle("b") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
wtp_pie <- ggplot(wtp_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8)) +
ggtitle("c") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
wtp_mui_pie <- ggplot(wtp_mui_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8)) +
ggtitle("d") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
## 4.2. Map
## --------
eng_border <- st_read('D:/Documents/SEER/____STATE_OF_GB____/SEER_GIS/Countries (Great Britain)/england_full_clipped.shp')
map <- ggplot() +
geom_sf(data = eng_border, fill = 'NA', lwd = 1) +
geom_sf(data = lsoa,
aes(fill = class),
color = NA) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8)) +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank(),
legend.position = "none")
pies <- ggarrange(local_pie, bio_pie, wtp_pie, wtp_mui_pie,
ncol = 2, nrow = 2,
common.legend = TRUE,
legend = 'bottom')
figure <- ggarrange(map, pies, ncol = 2, nrow = 1)
figure
save_path <- 'D:/Documents/NetGain/Maps/'
filename <- 'rural_urban_benefits.jpeg'
ggsave(filename=filename, plot = figure, device = "jpeg",
path = save_path, units = "in", width = 12, height = 5)
local_pie <- ggplot(local_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8),
labels = c('Rural benefits', 'Urban benefits')) +
ggtitle("a") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
bio_pie <- ggplot(bio_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8),
labels = c('Rural benefits', 'Urban benefits')) +
ggtitle("b") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
wtp_pie <- ggplot(wtp_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8),
labels = c('Rural benefits', 'Urban benefits')) +
ggtitle("c") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
wtp_mui_pie <- ggplot(wtp_mui_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 0.8),
labels = c('Rural benefits', 'Urban benefits')) +
ggtitle("d") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=8)
## 4.2. Map
## --------
# eng_border <- st_read('D:/Documents/SEER/____STATE_OF_GB____/SEER_GIS/Countries (Great Britain)/england_full_clipped.shp')
map <- ggplot() +
# geom_sf(data = eng_border, fill = 'NA', lwd = 1) +
geom_sf(data = lsoa,
aes(fill = class),
color = NA) +
scale_fill_manual(values = alpha(c('darkkhaki', 'ivory3'), 1)) +
theme_bw() +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank(),
legend.position = "none")
pies <- ggarrange(local_pie, bio_pie, wtp_pie, wtp_mui_pie,
ncol = 2, nrow = 2,
common.legend = TRUE,
legend = 'bottom')
figure <- ggarrange(map, pies, ncol = 2, nrow = 1)
save_path <- 'D:/Documents/NetGain/Maps/'
filename <- 'rural_urban_benefits.jpeg'
ggsave(filename=filename, plot = figure, device = "jpeg",
path = save_path, units = "in", width = 12, height = 5)
local_pie <- ggplot(local_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 0.8),
labels = c('Rural', 'Urban')) +
ggtitle("a") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=5)
bio_pie <- ggplot(bio_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 0.8),
labels = c('Rural', 'Urban')) +
ggtitle("b") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=5)
wtp_pie <- ggplot(wtp_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 0.8),
labels = c('Rural', 'Urban')) +
ggtitle("c") +
theme(
plot.title = element_text(size=30),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=5)
wtp_mui_pie <- ggplot(wtp_mui_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 0.8),
labels = c('Rural', 'Urban')) +
ggtitle("d") +
theme(
plot.title = element_text(size=30),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=5)
## 4.2. Map
## --------
# eng_border <- st_read('D:/Documents/SEER/____STATE_OF_GB____/SEER_GIS/Countries (Great Britain)/england_full_clipped.shp')
map <- ggplot() +
# geom_sf(data = eng_border, fill = 'NA', lwd = 1) +
geom_sf(data = lsoa,
aes(fill = class),
color = NA) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 1)) +
theme_bw() +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_blank(),
legend.title = element_blank(),
legend.position = "none")
pies <- ggarrange(local_pie, bio_pie, wtp_pie, wtp_mui_pie,
ncol = 2, nrow = 2,
common.legend = TRUE,
legend = 'bottom')
figure <- ggarrange(map, pies, ncol = 2, nrow = 1)
save_path <- 'D:/Documents/NetGain/Maps/'
filename <- 'rural_urban_benefits.jpeg'
ggsave(filename=filename, plot = figure, device = "jpeg",
path = save_path, units = "in", width = 12, height = 5)
local_pie <- ggplot(local_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 0.8),
labels = c('Rural', 'Urban')) +
ggtitle("a") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=5)
bio_pie <- ggplot(bio_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 0.8),
labels = c('Rural', 'Urban')) +
ggtitle("b") +
theme(
plot.title = element_text(size=30),
axis.text.x=element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=5)
wtp_pie <- ggplot(wtp_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 0.8),
labels = c('Rural', 'Urban')) +
ggtitle("c") +
theme(
plot.title = element_text(size=30),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=5)
wtp_mui_pie <- ggplot(wtp_mui_bng, aes(x="", y=values, fill=group))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 0.8),
labels = c('Rural', 'Urban')) +
ggtitle("d") +
theme(
plot.title = element_text(size=30),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid=element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = 'none') +
geom_text(aes(y = values/2 + c(0, cumsum(values)[-length(values)]),
label = percent(values, accuracy = 0.1)), size=5)
## 4.2. Map
## --------
# eng_border <- st_read('D:/Documents/SEER/____STATE_OF_GB____/SEER_GIS/Countries (Great Britain)/england_full_clipped.shp')
map <- ggplot() +
# geom_sf(data = eng_border, fill = 'NA', lwd = 1) +
geom_sf(data = lsoa,
aes(fill = class),
color = NA) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 1)) +
theme_bw() +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.position = "none")
pies <- ggarrange(local_pie, bio_pie, wtp_pie, wtp_mui_pie,
ncol = 2, nrow = 2,
common.legend = TRUE,
legend = 'bottom')
figure <- ggarrange(map, pies, ncol = 2, nrow = 1)
save_path <- 'D:/Documents/NetGain/Maps/'
filename <- 'rural_urban_benefits.jpeg'
ggsave(filename=filename, plot = figure, device = "jpeg",
path = save_path, units = "in", width = 12, height = 5)
map <- ggplot() +
# geom_sf(data = eng_border, fill = 'NA', lwd = 1) +
geom_sf(data = lsoa,
aes(fill = class),
color = NA) +
scale_fill_manual(values = alpha(c('darkkhaki', 'snow4'), 1)) +
theme_bw() +
theme(plot.title = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
legend.title = element_blank(),
legend.position = "none")
pies <- ggarrange(local_pie, bio_pie, wtp_pie, wtp_mui_pie,
ncol = 2, nrow = 2,
common.legend = TRUE,
legend = 'bottom')
figure <- ggarrange(map, pies, ncol = 2, nrow = 1)
save_path <- 'D:/Documents/NetGain/Maps/'
filename <- 'rural_urban_benefits.jpeg'
ggsave(filename=filename, plot = figure, device = "jpeg",
path = save_path, units = "in", width = 12, height = 8)
rm(list=ls())
library(raster)
library(sf)
## (1) LOAD THE DATA
## =================
## 1.1. SEER 2km grid
## ------------------
setwd('D:/Documents/Housing/Data/SEER_GIS/SEER_GRID/')
seer_2k <- st_read('SEER_net2km.shp')
